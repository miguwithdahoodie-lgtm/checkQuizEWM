<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Miguel's L√§nderanalyse ‚Äì Check-Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #020617;
      color: #f9fafb;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 16px;
    }
    .app {
      width: 100%;
      max-width: 780px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 8px;
      flex-wrap: wrap;
    }
    .brand {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .brand-title {
      font-size: 1.4rem;
      font-weight: 700;
    }
    .brand-sub {
      font-size: 0.8rem;
      color: #9ca3af;
    }
    .badge {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #4b5563;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      background: radial-gradient(circle at top, #111827, #020617);
    }
    .subtitle {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-bottom: 14px;
    }
    .card {
      background: radial-gradient(circle at top, #0f172a, #020617);
      border-radius: 18px;
      padding: 18px 16px 14px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.6);
      border: 1px solid #1f2937;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .tag-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
      font-size: 0.8rem;
      color: #9ca3af;
      flex-wrap: wrap;
      gap: 6px;
    }
    .pill {
      padding: 2px 10px;
      border-radius: 999px;
      border: 1px solid #374151;
      background: rgba(15,23,42,0.9);
      font-size: 0.75rem;
    }
    .counter {
      font-size: 0.8rem;
    }
    .status-pill {
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid transparent;
    }
    .status-none { display: none; }
    .status-correct {
      display: inline-block;
      background: rgba(22,163,74,0.15);
      border-color: #16a34a;
      color: #bbf7d0;
    }
    .status-partial {
      display: inline-block;
      background: rgba(234,179,8,0.15);
      border-color: #eab308;
      color: #facc15;
    }
    .status-wrong {
      display: inline-block;
      background: rgba(239,68,68,0.15);
      border-color: #ef4444;
      color: #fecaca;
    }
    .question {
      font-size: 1rem;
      line-height: 1.4;
      font-weight: 500;
    }
    textarea {
      width: 100%;
      min-height: 90px;
      border-radius: 12px;
      border: 1px solid #1f2937;
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      padding: 8px 10px;
      font-family: inherit;
      font-size: 0.9rem;
      resize: vertical;
    }
    textarea:focus {
      outline: none;
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79,70,229,0.5);
    }
    .label {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-bottom: 2px;
    }
    .result {
      font-size: 0.9rem;
      line-height: 1.4;
      border-radius: 10px;
      padding: 8px 10px;
      display: none;
      margin-top: 4px;
    }
    .result.visible { display: block; }
    .result.correct {
      background: rgba(22,163,74,0.12);
      border: 1px solid #16a34a;
      color: #bbf7d0;
    }
    .result.partial {
      background: rgba(234,179,8,0.1);
      border: 1px solid #eab308;
      color: #facc15;
    }
    .result.wrong {
      background: rgba(248,113,113,0.13);
      border: 1px solid #ef4444;
      color: #fecaca;
    }
    .solution {
      margin-top: 6px;
      font-size: 0.85rem;
      color: #e5e7eb;
    }
    .controls {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin-top: 4px;
      flex-wrap: wrap;
    }
    button {
      flex: 1;
      padding: 9px 10px;
      border-radius: 999px;
      border: none;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      background: #111827;
      color: #e5e7eb;
      border: 1px solid #1f2937;
      transition: background 0.15s, transform 0.1s, border-color 0.15s;
    }
    button.primary {
      background: linear-gradient(135deg, #4f46e5, #06b6d4);
      border-color: transparent;
      color: white;
    }
    button.small {
      flex: 0;
      padding-inline: 10px;
      font-size: 0.75rem;
    }
    button:active {
      transform: scale(0.97);
    }
    .hint {
      margin-top: 8px;
      font-size: 0.75rem;
      color: #9ca3af;
    }
    ul {
      margin-left: 18px;
      margin-top: 6px;
    }
    .score-row {
      display: flex;
      gap: 10px;
      font-size: 0.75rem;
      color: #9ca3af;
      margin-bottom: 6px;
      flex-wrap: wrap;
    }
    .score-pill {
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid #374151;
      background: rgba(15,23,42,0.9);
    }
    .score-pill span { font-weight: 600; }
    @media (min-width: 640px) {
      .brand-title { font-size: 1.6rem; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="brand-title">Miguel's L√§nderanalyse</div>
        <div class="brand-sub">Emerging Asia ‚Ä¢ Check-Quiz (Freitext)</div>
      </div>
      <div class="badge">HRW ‚Ä¢ WS 25/26</div>
    </header>
    <p class="subtitle">
      Schreib deine Antwort in eigenen Worten. Ich checke automatisch, ob wichtige Schl√ºsselw√∂rter drin sind (mind. 1‚Äì2 Treffer = teilweise / richtig).
    </p>

    <div class="score-row">
      <div class="score-pill">‚úÖ Richtig: <span id="scoreCorrect">0</span></div>
      <div class="score-pill">üü° Teilweise: <span id="scorePartial">0</span></div>
      <div class="score-pill">‚ùå Falsch: <span id="scoreWrong">0</span></div>
    </div>

    <div class="card" id="card">
      <div>
        <div class="tag-row">
          <span class="pill" id="topicPill">Thema</span>
          <span class="counter" id="counter">1 / 1</span>
          <span class="status-pill status-none" id="statusPill"></span>
        </div>
        <div class="question" id="questionText"></div>
      </div>

      <div>
        <div class="label">Deine Antwort:</div>
        <textarea id="userAnswer" placeholder="Schreib deine Definition/Erkl√§rung hier rein..."></textarea>
      </div>

      <div>
        <button class="primary" id="checkBtn">Pr√ºfen</button>
        <div class="result" id="resultBox">
          <div id="resultText"></div>
          <div class="solution">
            Musterl√∂sung:<br>
            <span id="solutionText"></span>
          </div>
        </div>
      </div>

      <div class="controls">
        <button id="prevBtn">‚üµ Zur√ºck</button>
        <button id="clearBtn">Antwort l√∂schen</button>
        <button id="nextBtn">Weiter ‚ü∂</button>
        <button class="small" id="shuffleBtn">üîÄ Shuffle</button>
      </div>

      <p class="hint">
        Tipp: Nutze Stichworte wie ‚Äû√úbergang‚Äú, ‚ÄûIndustrieland‚Äú, ‚ÄûFDI‚Äú, ‚ÄûSoft Power‚Äú usw. ‚Äì genau danach sucht der Checker.
      </p>
    </div>
  </div>

  <script>
    const questions = [
      {
        topic: "Emerging Markets",
        q: "Definiere: Was sind Emerging Markets?",
        solution: "L√§nder, die sich im √úbergang vom Entwicklungsland zum Industrieland befinden ‚Äì mit wachsendem Einkommen, Industrialisierung und st√§rkerer Einbindung in die Weltwirtschaft.",
        keywords: [
          ["√ºbergang", "transition"],
          ["entwicklungsland", "developing"],
          ["industrieland", "industrial", "entwickeltes land"],
          ["wachstum", "wachsende", "einkommen", "wohlstand"]
        ]
      },
      {
        topic: "Emerging Markets",
        q: "Nenne typische Merkmale von Emerging Markets.",
        solution: "√úberdurchschnittliches Wachstumspotenzial, gro√üe Markt- und Expansionschancen f√ºr Unternehmen und Bedarf an speziellen Internationalisierungsstrategien.",
        keywords: [
          ["wachstum", "wachstumspotenzial"],
          ["markt", "marktpote", "expansions"],
          ["internationalisierung", "strategie", "strategien"]
        ]
      },
      {
        topic: "Emerging Asia",
        q: "Was versteht man unter ‚ÄûEmerging Asia‚Äú und welche L√§nder geh√∂ren typischerweise dazu?",
        solution: "Eine Gruppe dynamisch wachsender asiatischer Volkswirtschaften, meist China, Indien, Malaysia, Thailand, Vietnam und die Philippinen.",
        keywords: [
          ["dynamisch", "wachsend"],
          ["asiatisch", "asien"],
          ["china", "indien", "malaysia", "thailand", "vietnam", "philippinen"]
        ]
      },
      {
        topic: "L√§nderklassifikation",
        q: "Wie klassifiziert die Weltbank L√§nder nach Einkommen?",
        solution: "Nach dem GNI pro Kopf (Einkommensniveau) in die Gruppen: Low Income, Lower Middle Income, Upper Middle Income und High Income.",
        keywords: [
          ["weltbank"],
          ["gni", "einkommen", "pro kopf"],
          ["low income", "low-income", "niedrig"],
          ["middle income", "lower middle", "upper middle"],
          ["high income", "hoch einkommen"]
        ]
      },
      {
        topic: "L√§nderklassifikation",
        q: "Wie teilt die UNO L√§nder nach Entwicklungsstand ein?",
        solution: "In Low Human Development, Medium Human Development und High Human Development, oft gemessen am Human Development Index (HDI).",
        keywords: [
          ["uno", "un"],
          ["low human", "niedriges human"],
          ["medium human", "mittleres human"],
          ["high human", "hohes human"],
          ["hdi", "human development index"]
        ]
      },
      {
        topic: "L√§nderklassifikation",
        q: "Welche drei Gruppen verwendet der IMF f√ºr L√§nder?",
        solution: "Low Income Developing Countries, Emerging Economies und Advanced Countries.",
        keywords: [
          ["imf", "iwf"],
          ["low income"],
          ["emerging"],
          ["advanced"]
        ]
      },
      {
        topic: "Wirtschaftlicher Aufstieg",
        q: "Erkl√§re BIP pro Kopf (GDP per capita) und warum es wichtig ist.",
        solution: "BIP pro Kopf ist das Bruttoinlandsprodukt geteilt durch die Bev√∂lkerungszahl und beschreibt die durchschnittliche Wirtschaftsleistung bzw. den Wohlstand pro Einwohner.",
        keywords: [
          ["bip pro kopf", "gdp per capita"],
          ["bruttoinlandsprodukt", "bip"],
          ["bev√∂lkerung", "einwohner"],
          ["durchschnitt", "wohlstand"]
        ]
      },
      {
        topic: "Wirtschaftlicher Aufstieg",
        q: "Nenne mehrere Indikatoren, mit denen man den wirtschaftlichen Aufstieg asiatischer L√§nder beschreiben kann.",
        solution: "BIP pro Kopf, BIP-Wachstum, Sektorenstruktur, Au√üenhandelsquote und ausl√§ndische Direktinvestitionen (FDI/ADI).",
        keywords: [
          ["bip pro kopf", "gdp per capita"],
          ["wachstum", "bip-wachstum"],
          ["sektorenstruktur", "sektor"],
          ["au√üenhandelsquote", "au√üenhandel"],
          ["fdi", "adi", "direktinvestition"]
        ]
      },
      {
        topic: "Flugg√§nsemodell",
        q: "Beschreibe das Flugg√§nsemodell in 2‚Äì3 S√§tzen.",
        solution: "Ein Leitland wie Japan entwickelt bestimmte Industrien zuerst, importiert Rohstoffe, produziert und exportiert Industrieprodukte. Wenn L√∂hne steigen, werden arbeitsintensive Produktionen in L√§nder mit niedrigeren L√∂hnen verlagert. Diese Nachfolgel√§nder holen technologisch auf und durchlaufen √§hnliche Entwicklungsstufen.",
        keywords: [
          ["leitland", "f√ºhrendes land", "japan"],
          ["rohstoffe", "import"],
          ["produktion", "industrieprodukte", "export"],
          ["l√∂hne", "lohnkosten", "steigend"],
          ["verlagert", "verlagerung"],
          ["√§rmere l√§nder", "niedrigere l√∂hne", "nachfolgel√§nder"]
        ]
      },
      {
        topic: "Zwischenstaatliche Beziehungen",
        q: "Z√§hle die vier Teilbereiche der zwischenstaatlichen Wirtschaftsbeziehungen auf.",
        solution: "Handel, Direktinvestitionen, Institutionen bzw. Wirtschaftsabkommen und das Gesch√§ftsklima.",
        keywords: [
          ["handel"],
          ["direktinvestition", "fdi"],
          ["institution", "wirtschaftsabkommen", "freihandel", "wto"],
          ["gesch√§ftsklima", "business climate"]
        ]
      },
      {
        topic: "Handel",
        q: "Erkl√§re Handelsvolumen, Handelsbilanz und Handelsstruktur.",
        solution: "Handelsvolumen ist Export plus Import. Die Handelsbilanz ist Export minus Import (√úberschuss bei mehr Exporten, Defizit bei mehr Importen). Die Handelsstruktur beschreibt, welche Arten von G√ºtern gehandelt werden, z. B. einfache Rohstoffe oder Hightech-Produkte.",
        keywords: [
          ["handelsvolumen", "export + import"],
          ["handelsbilanz", "export - import"],
          ["√ºberschuss", "defizit"],
          ["handelsstruktur", "g√ºterstruktur", "arten von g√ºtern"]
        ]
      },
      {
        topic: "Bedeutung Asiens",
        q: "Nenne die wichtigsten Gr√ºnde, warum Asien f√ºr die deutsche Wirtschaft wichtig ist.",
        solution: "Asien ist ein zentraler Handelspartner (Export von Autos, Maschinen, Hightech; Import von Elektronik, Textilien, Vorprodukten), Produktionsstandort in globalen Lieferketten und bietet wachsende Zukunftsm√§rkte durch steigende Mittelschichten und Infrastrukturbedarf.",
        keywords: [
          ["handelspartner", "handel"],
          ["autos", "maschinen", "hightech", "chemie"],
          ["elektronik", "textilien", "konsumg√ºter", "vorprodukte"],
          ["produktion", "lieferkette", "supply chain"],
          ["wachstum", "zukunftsm√§rkte", "mittelschicht"]
        ]
      },
      {
        topic: "Heckscher-Ohlin",
        q: "Erkl√§re das Heckscher-Ohlin-Theorem.",
        solution: "Es besagt, dass ein Land die G√ºter exportiert, f√ºr deren Produktion sein reichlich vorhandener Produktionsfaktor (Arbeit oder Kapital) intensiv genutzt wird, und die G√ºter importiert, bei denen der knappe Faktor intensiv ist.",
        keywords: [
          ["heckscher", "ohlin"],
          ["produktionsfaktor", "arbeit", "kapital"],
          ["reichlich", "relativ reich"],
          ["knapp", "relativ knapp"],
          ["exportiert", "importiert"]
        ]
      },
      {
        topic: "Heckscher-Ohlin",
        q: "Wie passt die Handelsg√ºterstruktur zwischen Deutschland und vielen asiatischen L√§ndern zum Heckscher-Ohlin-Theorem?",
        solution: "Deutschland mit viel Kapital exportiert vor allem kapitalintensive G√ºter wie Autos und Maschinen. Viele asiatische L√§nder mit viel Arbeitskraft exportieren eher arbeitsintensive G√ºter wie Textilien, Kleidung und einfachere Industriewaren.",
        keywords: [
          ["deutschland"],
          ["kapitalintensiv", "autos", "maschinen"],
          ["asiatisch", "asien"],
          ["arbeitsintensiv", "textilien", "kleidung"]
        ]
      },
      {
        topic: "Politisches System",
        q: "Was ist ein politisches System und welche drei Dimensionen unterscheidet man?",
        solution: "Ein politisches System umfasst die Strukturen, Prozesse und Inhalte, die das Zusammenleben im Staat regeln. Man unterscheidet Policy (Inhalte, Programme, Ziele), Politics (Prozesse, Konflikte, Wahlen) und Polity (Strukturen, Verfassung, Institutionen).",
        keywords: [
          ["strukturen", "prozesse", "inhalte"],
          ["zusammenleben", "staat"],
          ["policy", "programme", "ziele"],
          ["politics", "prozesse", "wahlen", "konflikte"],
          ["polity", "verfassung", "institutionen"]
        ]
      },
      {
        topic: "Geopolitik",
        q: "Was ist ein geopolitischer Schock? Nenne ein Beispiel und eine m√∂gliche wirtschaftliche Folge.",
        solution: "Ein geopolitischer Schock ist ein pl√∂tzliches politisch-√∂konomisches Ereignis mit starken wirtschaftlichen Folgen, z. B. Terroranschl√§ge, Kriege, Pandemien oder Handelskonflikte. Folgen k√∂nnen h√∂here Energiepreise, R√ºckzug ausl√§ndischer Investoren, Einbruch des Tourismus oder sinkender Konsum sein.",
        keywords: [
          ["geopolitisch"],
          ["schock", "krise"],
          ["terror", "krieg", "pandemie", "handelskonflikt", "zoll"],
          ["energiepreise", "investoren", "tourismus", "konsum"]
        ]
      },
      {
        topic: "Soziale Struktur",
        q: "Nenne verschiedene Dimensionen der Sozialstruktur eines Landes und jeweils ein Beispiel.",
        solution: "Dimensionen sind z. B. demografische Struktur (Altersstruktur, Fertilit√§tsrate, Abh√§ngigkeitsquote), Besch√§ftigung (Erwerbsbeteiligung, Besch√§ftigungsquote), Bildung (Bildungsstand), Ungleichheit (Gini, Armutsquote) und Gesundheit (Lebenserwartung, S√§uglings- und Suizidsterblichkeit).",
        keywords: [
          ["demografisch", "altersstruktur", "fertilit√§t", "abh√§ngigkeitsquote"],
          ["besch√§ftigung", "erwerbsbeteiligung"],
          ["bildung", "bildungsstand"],
          ["ungleichheit", "gini", "armutsquote"],
          ["gesundheit", "lebenserwartung", "s√§uglings", "suizid"]
        ]
      },
      {
        topic: "Ungleichheit",
        q: "Erkl√§re kurz Gini-Koeffizient und Armutsquote.",
        solution: "Der Gini-Koeffizient misst die Ungleichverteilung von Einkommen zwischen Haushalten (0 = gleich, 1 bzw. 100 = sehr ungleich). Die Armutsquote gibt an, wie viel Prozent der Bev√∂lkerung unterhalb der Armutsgrenze leben.",
        keywords: [
          ["gini"],
          ["ungleichverteilung", "einkommen"],
          ["armutsquote", "armut"],
          ["armutsgrenze", "unterhalb"]
        ]
      },
      {
        topic: "Dualistische Struktur",
        q: "Was ist eine dualistische Struktur in Wirtschaft und Gesellschaft? Nenne ein Beispiel.",
        solution: "Sie beschreibt das Nebeneinander eines modernen, produktiven, oft exportorientierten Sektors und eines traditionellen, wenig produktiven Sektors. Beispiel: High-Tech-St√§dte und wohlhabende K√ºstenregionen gegen√ºber armen, agrarisch gepr√§gten l√§ndlichen Regionen.",
        keywords: [
          ["dualistisch", "duale struktur"],
          ["modern", "exportorientiert"],
          ["traditionell", "agrarisch", "wenig produktiv"],
          ["beispiel", "stadt", "land", "k√ºstenregion"]
        ]
      },
      {
        topic: "Eisbergmodell",
        q: "Erkl√§re das Eisbergmodell der Kultur mit den Begriffen Perceptas und Conceptas.",
        solution: "Das Eisbergmodell zeigt, dass nur ein kleiner Teil der Kultur sichtbar ist (Perceptas wie Verhalten, Rituale, Geb√§ude), w√§hrend der gr√∂√üte Teil unsichtbar ist (Conceptas wie Werte, Normen, Denkweisen und Gef√ºhle), die das sichtbare Verhalten erkl√§ren.",
        keywords: [
          ["eisberg"],
          ["perceptas", "sichtbar", "verhalten", "rituale", "geb√§ude"],
          ["conceptas", "unsichtbar", "werte", "normen", "denkweisen", "gef√ºhle"]
        ]
      },
      {
        topic: "Asiatische Kultur",
        q: "Nenne Beispiele f√ºr asiatische Kultur und passende Werte dahinter.",
        solution: "Beispiele: K-Wave (K-Pop, Serien) steht f√ºr Attraktivit√§t und Modernit√§t; Essen mit St√§bchen und gemeinsames Essen f√ºr Gemeinschaft und Harmonie; langes Arbeiten und Leistungsdruck f√ºr Disziplin, Flei√ü und Bildungserfolg.",
        keywords: [
          ["k-wave", "kpop", "k-pop", "k-drama"],
          ["essen", "st√§bchen", "reis"],
          ["arbeit", "leistungsorientierung", "lange arbeitszeiten", "disziplin"],
          ["gemeinschaft", "harmonie", "familie"]
        ]
      },
      {
        topic: "Soft Power",
        q: "Definiere Soft Power und erkl√§re, wie S√ºdkorea sie mit der K-Wave nutzt.",
        solution: "Soft Power bedeutet, andere durch Attraktivit√§t von Kultur, Werten und Politik zu beeinflussen statt durch Zwang und milit√§rische oder wirtschaftliche Drohung (Hard Power). S√ºdkorea nutzt K-Pop, Serien, Mode und Essen, um das Land attraktiv zu machen und Tourismus, Spracherwerb und Konsum koreanischer Produkte zu f√∂rdern.",
        keywords: [
          ["soft power"],
          ["attraktivit√§t", "anziehung", "kultur", "werte"],
          ["kein zwang", "nicht milit√§risch", "hard power"],
          ["k-wave", "kpop", "k-pop", "k-drama"],
          ["tourismus", "produkte", "sprache"]
        ]
      },
      {
        topic: "Innovation",
        q: "Was misst die ‚ÄûTaxonomy of Economic Activities based on R&D Intensity‚Äú und was bedeutet technologische Intensit√§t?",
        solution: "Sie teilt Branchen nach ihrer Forschungs- und Entwicklungsintensit√§t ein, also danach, wie hoch die F&E-Ausgaben im Verh√§ltnis zur Wertsch√∂pfung sind. Technologische Intensit√§t beschreibt, wie stark ein Sektor auf Forschung, Entwicklung und Hightech basiert (High, Medium-High, Medium, Medium-Low, Low).",
        keywords: [
          ["taxonomy", "economic activities"],
          ["r&d", "f&e", "forschung", "entwicklung"],
          ["intensit√§t"],
          ["wertsch√∂pfung"],
          ["high tech", "high-tech", "technologisch"]
        ]
      }
    ];

    let index = 0;
    const userTexts = Array(questions.length).fill("");
    const userStatuses = Array(questions.length).fill(null);
    let scoreCorrect = 0, scorePartial = 0, scoreWrong = 0;

    const topicPill = document.getElementById("topicPill");
    const counter = document.getElementById("counter");
    const statusPill = document.getElementById("statusPill");
    const questionText = document.getElementById("questionText");
    const userAnswer = document.getElementById("userAnswer");
    const resultBox = document.getElementById("resultBox");
    const resultText = document.getElementById("resultText");
    const solutionText = document.getElementById("solutionText");
    const checkBtn = document.getElementById("checkBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const shuffleBtn = document.getElementById("shuffleBtn");
    const clearBtn = document.getElementById("clearBtn");
    const cardEl = document.getElementById("card");
    const scoreCorrectEl = document.getElementById("scoreCorrect");
    const scorePartialEl = document.getElementById("scorePartial");
    const scoreWrongEl = document.getElementById("scoreWrong");

    function updateScores() {
      scoreCorrectEl.textContent = scoreCorrect;
      scorePartialEl.textContent = scorePartial;
      scoreWrongEl.textContent = scoreWrong;
    }

    function setStatusPill(status) {
      statusPill.className = "status-pill";
      if (!status) {
        statusPill.classList.add("status-none");
        statusPill.textContent = "";
        return;
      }
      statusPill.classList.remove("status-none");
      if (status === "correct") {
        statusPill.classList.add("status-correct");
        statusPill.textContent = "‚úÖ Richtig";
      } else if (status === "partial") {
        statusPill.classList.add("status-partial");
        statusPill.textContent = "üü° Teilweise";
      } else if (status === "wrong") {
        statusPill.classList.add("status-wrong");
        statusPill.textContent = "‚ùå Falsch";
      }
    }

    function renderQuestion() {
      const q = questions[index];
      topicPill.textContent = q.topic;
      counter.textContent = (index + 1) + " / " + questions.length;
      questionText.textContent = q.q;
      solutionText.textContent = q.solution;
      userAnswer.value = userTexts[index] || "";
      const status = userStatuses[index];
      setStatusPill(status);
      if (status) {
        resultBox.className = "result visible " + status;
        if (status === "correct") {
          resultText.textContent = "Stark, Kernpunkte getroffen ‚úÖ";
        } else if (status === "partial") {
          resultText.textContent = "Teilweise richtig ‚Äì ein, zwei Kernbegriffe fehlen noch.";
        } else {
          resultText.textContent = "Noch nicht ganz ‚Äì vergleiche mit der Musterl√∂sung.";
        }
      } else {
        resultBox.className = "result";
        resultText.textContent = "";
      }
    }

    function evaluateAnswer() {
      const q = questions[index];
      const answer = (userAnswer.value || "").toLowerCase();
      userTexts[index] = userAnswer.value;

      if (!answer.trim()) {
        alert("Schreib zuerst eine Antwort, bevor du pr√ºfst üòâ");
        return;
      }

      let hitGroups = 0;
      q.keywords.forEach(group => {
        if (group.some(kw => answer.includes(kw))) {
          hitGroups++;
        }
      });

      const totalGroups = q.keywords.length;
      let status;
      if (hitGroups === 0) {
        status = "wrong";
      } else if (hitGroups === 1 || hitGroups / totalGroups < 0.5) {
        status = "partial";
      } else {
        status = "correct";
      }

      const prevStatus = userStatuses[index];
      if (prevStatus !== status) {
        if (prevStatus === "correct") scoreCorrect--;
        if (prevStatus === "partial") scorePartial--;
        if (prevStatus === "wrong") scoreWrong--;

        if (status === "correct") scoreCorrect++;
        if (status === "partial") scorePartial++;
        if (status === "wrong") scoreWrong++;
        updateScores();
      }

      userStatuses[index] = status;
      setStatusPill(status);
      resultBox.className = "result visible " + status;

      if (status === "correct") {
        resultText.textContent = "Stark, Kernpunkte getroffen ‚úÖ";
      } else if (status === "partial") {
        resultText.textContent = "Teilweise richtig ‚Äì ein, zwei Kernbegriffe fehlen noch.";
      } else {
        resultText.textContent = "Noch nicht ganz ‚Äì vergleiche mit der Musterl√∂sung.";
      }
    }

    function nextQuestion() {
      index = (index + 1) % questions.length;
      renderQuestion();
      userAnswer.focus();
    }

    function prevQuestion() {
      index = (index - 1 + questions.length) % questions.length;
      renderQuestion();
      userAnswer.focus();
    }

    function shuffleQuestions() {
      for (let i = questions.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [questions[i], questions[j]] = [questions[j], questions[i]];
        [userTexts[i], userTexts[j]] = [userTexts[j], userTexts[i]];
        [userStatuses[i], userStatuses[j]] = [userStatuses[j], userStatuses[i]];
      }
      index = 0;
      renderQuestion();
      userAnswer.focus();
    }

    checkBtn.addEventListener("click", evaluateAnswer);
    nextBtn.addEventListener("click", nextQuestion);
    prevBtn.addEventListener("click", prevQuestion);
    shuffleBtn.addEventListener("click", shuffleQuestions);
    clearBtn.addEventListener("click", () => {
      userAnswer.value = "";
      userTexts[index] = "";
      userStatuses[index] = null;
      renderQuestion();
      userAnswer.focus();
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowRight") nextQuestion();
      if (e.key === "ArrowLeft") prevQuestion();
      if (e.key === "Enter" && (e.metaKey || e.ctrlKey)) {
        e.preventDefault();
        evaluateAnswer();
      }
    });

    let startX = null;
    cardEl.addEventListener("touchstart", (e) => {
      startX = e.touches[0].clientX;
    });
    cardEl.addEventListener("touchend", (e) => {
      if (startX === null) return;
      const endX = e.changedTouches[0].clientX;
      const diff = endX - startX;
      if (Math.abs(diff) > 50) {
        if (diff < 0) nextQuestion();
        else prevQuestion();
      }
      startX = null;
    });

    renderQuestion();
    updateScores();
    userAnswer.focus();
  </script>
</body>
</html>
